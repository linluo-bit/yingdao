# 影刀RPA - 桌面自动化软件

一个基于Python和PyQt6开发的RPA（机器人流程自动化）桌面应用，提供可视化的流程设计、网页自动化、桌面操作等功能。

## 新增功能

### 🎯 元素捕获功能
- **集成式元素捕获**：在"点击元素(web)"指令中集成元素捕获功能
- **Chrome插件支持**：开发了专门的Chrome浏览器插件用于元素捕获
- **多种选择器支持**：自动生成CSS选择器、XPath、ID、Name等多种选择器
- **实时高亮显示**：捕获时实时高亮显示目标元素
- **智能数据传递**：Chrome插件与RPA应用之间的智能数据传递

### 🔧 自动化插件管理
- **插件管理界面**：提供可视化的自动化插件管理界面
- **插件安装向导**：简化插件的安装和配置过程
- **插件状态监控**：实时监控插件的运行状态

## 技术架构

### 核心组件
- **GUI框架**：PyQt6 - 现代化的跨平台GUI框架
- **自动化引擎**：基于Selenium的Web自动化
- **流程设计器**：可视化的拖拽式流程设计
- **Chrome插件**：元素捕获和选择器生成
- **数据传递**：文件系统作为Chrome插件与RPA应用的桥梁

### 技术栈
- **前端**：PyQt6, QGraphicsView, QTreeWidget
- **后端**：Python 3.8+, asyncio, Selenium
- **浏览器插件**：Chrome Extension Manifest V3, JavaScript
- **数据存储**：JSON, Chrome Storage API

## 安装和使用

### 环境要求
- Python 3.8+
- Chrome浏览器
- Windows 10/11

### 快速开始
1. **克隆项目**
   ```bash
   git clone https://github.com/linluo-bit/yingdao.git
   cd yingdao
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **安装Chrome插件**
   - 打开Chrome浏览器
   - 访问 `chrome://extensions/`
   - 开启"开发者模式"
   - 点击"加载已解压的扩展程序"
   - 选择项目中的 `chrome-extension` 文件夹

4. **运行应用**
   ```bash
   python main.py
   ```

## Chrome插件安装

### 详细安装步骤

1. **下载插件文件**
   - 确保项目中的 `chrome-extension` 文件夹完整

2. **安装到Chrome**
   - 打开Chrome浏览器
   - 在地址栏输入：`chrome://extensions/`
   - 开启右上角的"开发者模式"
   - 点击"加载已解压的扩展程序"
   - 选择项目中的 `chrome-extension` 文件夹
   - 插件安装完成，会在工具栏显示图标

3. **验证安装**
   - 插件图标应该出现在Chrome工具栏
   - 点击插件图标应该能看到弹窗界面
   - 在任意网页上按住Ctrl键应该能看到鼠标变成十字形

### 插件功能
- **元素捕获**：按住Ctrl+鼠标左键捕获网页元素
- **选择器生成**：自动生成CSS、XPath等多种选择器
- **数据导出**：支持导出捕获的元素数据
- **批量捕获**：支持连续捕获多个元素

## 使用指南

### 基本操作
1. **创建项目**：点击"文件" → "新建项目"
2. **设计流程**：从左侧指令库拖拽指令到画布
3. **配置指令**：双击指令进行详细配置
4. **运行流程**：点击"运行"按钮执行自动化流程

### 元素捕获使用
1. **添加点击元素指令**
   - 从指令库拖拽"点击元素(web)"到画布
   - 双击打开配置对话框

2. **使用元素捕获**
   - 选择选择器类型（CSS、XPath、ID、Name）
   - 点击"🔍 捕获元素"按钮
   - 按照提示切换到浏览器窗口
   - 按住Ctrl键进入捕获模式
   - 鼠标悬停时会高亮显示元素
   - 按住Ctrl+鼠标左键点击要捕获的元素
   - 返回RPA应用，选择器会自动填入

3. **验证和运行**
   - 检查自动填入的选择器是否正确
   - 点击"确定"完成配置
   - 运行流程测试效果

### 网页自动化
- **打开网页**：指定URL打开目标网页
- **点击元素**：使用选择器点击网页元素
- **填写表单**：自动填写输入框内容
- **获取内容**：提取网页文本或数据
- **等待操作**：设置等待时间或条件

### 桌面自动化
- **鼠标操作**：点击、拖拽、滚动等
- **键盘输入**：文本输入、快捷键等
- **窗口管理**：打开、关闭、切换窗口
- **文件操作**：复制、移动、删除文件

## 项目结构

```
影刀/
├── main.py                      # 主程序入口
├── requirements.txt             # 依赖包列表
├── README.md                   # 项目说明
├── 元素捕获功能使用说明.md        # 元素捕获详细说明
├── chrome-extension/           # Chrome插件
│   ├── manifest.json          # 插件配置
│   ├── content.js            # 元素捕获逻辑
│   ├── background.js         # 后台管理
│   ├── popup.html           # 插件界面
│   ├── popup.js            # 插件逻辑
│   ├── content.css         # 样式文件
│   ├── install.bat         # 安装脚本
│   ├── icons/             # 插件图标
│   └── README.md          # 插件说明
├── captured_elements/      # 捕获的元素文件
├── src/                   # 源代码
│   ├── automation/        # 自动化模块
│   │   └── web/          # 网页自动化
│   └── core/             # 核心引擎
└── venv/                 # 虚拟环境
```

## 开发说明

### 代码结构
- **main.py**：主窗口和UI逻辑
- **src/core/engine.py**：自动化执行引擎
- **src/automation/web/instructions.py**：网页自动化指令
- **chrome-extension/**：Chrome插件相关文件

### 扩展开发
- **添加新指令**：在`src/automation/web/instructions.py`中实现
- **修改UI**：编辑`main.py`中的界面代码
- **插件开发**：修改`chrome-extension/`中的文件

## 更新日志

### v1.1.0 (最新)
- ✨ 新增元素捕获功能，集成到点击元素指令中
- 🔧 开发Chrome浏览器插件用于元素捕获
- 📦 添加自动化插件管理界面
- 🎨 优化UI布局和用户体验
- 🐛 修复WebDriver连接问题
- 📝 完善文档和使用说明

### v1.0.0
- 🎉 初始版本发布
- 📋 基础RPA功能
- 🖥️ 可视化流程设计
- 🌐 网页自动化支持
- 🖱️ 桌面操作功能

## 贡献指南

欢迎提交Issue和Pull Request来改进项目！

## 许可证

MIT License 